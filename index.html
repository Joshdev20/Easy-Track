<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Easy Track | Real-time Tracking</title>
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    #map { height: 300px; width: 100%; }
    .hidden { display: none; }
    .tracking-detail { background-color: #f0f9ff; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #38bdf8; margin-bottom: 1rem; }
    .tracking-title { font-weight: bold; font-size: 1.125rem; color: #1e3a8a; }
  </style>
</head>
<body class="bg-gray-100 font-sans text-gray-800">

  <div class="max-w-4xl mx-auto my-12 bg-white p-8 rounded-lg shadow-lg">
    <h2 class="text-3xl font-semibold text-center mb-6 text-indigo-700">Track Your Product</h2>

    <!-- Product Form -->
    <form id="productForm" class="space-y-4">
      <div>
        <label for="destination" class="block text-lg font-medium text-gray-700">Enter your delivery address:</label>
        <input type="text" id="destination" placeholder="Enter address" class="w-full p-3 mt-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500" required />
      </div>

      <button type="submit" class="w-full py-3 px-6 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">Track Package</button>
    </form>

    <!-- Product Info Section -->
    <div id="productInfo" class="hidden mt-8">
      <h3 class="text-2xl font-semibold text-gray-700 mb-4">Tracking Code: <span id="trackingCode" class="font-semibold text-indigo-600"></span></h3>
      <p id="arrivalDuration" class="text-lg text-gray-700 mb-4"></p>
      <div id="map"></div>
    </div>

    <!-- Tracking Code Form -->
    <div class="mt-8">
      <h3 class="text-2xl font-semibold mb-4">Enter Your Tracking Code</h3>
      <form id="trackingForm" class="space-y-4">
        <div>
          <input type="text" id="trackingInput" placeholder="Enter tracking code" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500" required />
        </div>

        <button type="submit" class="w-full py-3 px-6 bg-green-600 text-white font-bold rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500">Track</button>
      </form>
    </div>

    <!-- Tracking Details -->
    <div id="trackingDetails" class="hidden mt-8">
      <div class="tracking-detail">
        <p class="tracking-title">Current Location:</p>
        <p id="currentLocation" class="text-lg text-gray-700">Tracking your package...</p>
      </div>
      <div class="tracking-detail">
        <p class="tracking-title">Status Update:</p>
        <p id="statusUpdate" class="text-lg text-gray-700">Your package is on its way!</p>
      </div>
      <div class="tracking-detail">
        <p class="tracking-title">Estimated Arrival:</p>
        <p id="arrivalEstimate" class="text-lg text-gray-700">3-5 business days</p>
      </div>
    </div>
  </div>

  <script>
    // Generate a simple tracking code
    function generateTrackingCode() {
      const prefix = 'TRACK';
      const timestamp = Date.now();
      const randomString = Math.random().toString(36).substring(2, 10);
      return prefix + timestamp + randomString;
    }

    // Mock tracking data
    const trackingCode = generateTrackingCode();
    document.getElementById('trackingCode').textContent = trackingCode;

    // Initialize the map
    let map;
    let marker;
    let destinationCoordinates = [40.730610, -73.935242]; // Default to New York, for example

    function initMap(coords) {
      map = L.map('map').setView(coords, 12);

      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

      marker = L.marker(coords).addTo(map);
    }

    // Simulated tracking: Move marker to simulate package movement
    function startTracking() {
      let i = 0;
      const trackPath = [
        [40.730610, -73.935242], // New York coordinates (start)
        [40.740610, -73.955242], // New coordinates (moving forward)
        [40.750610, -73.975242]  // Destination (end)
      ];

      const interval = setInterval(() => {
        if (i < trackPath.length) {
          marker.setLatLng(trackPath[i]);
          i++;
        } else {
          clearInterval(interval);
        }
      }, 3000); // Update every 3 seconds
    }

    // Handle address submission
    document.getElementById('productForm').addEventListener('submit', function (event) {
      event.preventDefault();
      const destination = document.getElementById('destination').value;

      if (!destination) return;

      fetch(`https://nominatim.openstreetmap.org/search?q=${destination}&format=json`)
        .then(response => response.json())
        .then(data => {
          if (data && data.length > 0) {
            const lat = data[0].lat;
            const lon = data[0].lon;
            destinationCoordinates = [lat, lon];
            document.getElementById('arrivalDuration').textContent = "Estimated Arrival: 3-5 business days";
            document.getElementById('productInfo').classList.remove('hidden');
            initMap(destinationCoordinates);
            startTracking();
          } else {
            alert("Location not found, please try again.");
          }
        })
        .catch(error => alert("Unable to fetch location. Please try again."));
    });

    // Handle tracking code form submission
    document.getElementById('trackingForm').addEventListener('submit', function (event) {
      event.preventDefault();
      const trackingInput = document.getElementById('trackingInput').value;
      const trackingCodeInput = trackingInput.trim();

      if (trackingCodeInput === trackingCode) {
        document.getElementById('trackingDetails').classList.remove('hidden');
        document.getElementById('currentLocation').textContent = "Package is currently in transit.";
        document.getElementById('statusUpdate').textContent = "Package is moving towards the destination.";
        document.getElementById('arrivalEstimate').textContent = "Estimated Arrival: 3-5 business days";
      } else {
        alert("Invalid tracking code. Please try again.");
      }
    });
  </script>
</body>
          </html>
